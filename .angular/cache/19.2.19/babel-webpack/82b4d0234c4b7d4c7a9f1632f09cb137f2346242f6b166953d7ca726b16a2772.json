{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../services/order.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction CheckoutComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵelement(1, \"div\", 7);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CheckoutComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1, \"\\n\\u0627\\u0644\\u0633\\u0644\\u0629 \\u0641\\u0627\\u0631\\u063A\\u0629\\n\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CheckoutComponent_div_6_li_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 30)(1, \"div\", 31);\n    i0.ɵɵelement(2, \"img\", 32);\n    i0.ɵɵelementStart(3, \"div\")(4, \"div\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"small\", 33);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(8, \"span\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const item_r2 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", item_r2.image, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r2.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Size: \", item_r2.size, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", item_r2.price * item_r2.quantity, \" EGP\");\n  }\n}\nfunction CheckoutComponent_div_6_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 34);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r2.message);\n  }\n}\nfunction CheckoutComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 9)(1, \"div\", 10)(2, \"div\", 11)(3, \"h5\", 12);\n    i0.ɵɵtext(4, \"\\u062A\\u0641\\u0627\\u0635\\u064A\\u0644 \\u0627\\u0644\\u0633\\u0644\\u0629\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"ul\", 13);\n    i0.ɵɵtemplate(6, CheckoutComponent_div_6_li_6_Template, 10, 4, \"li\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 15);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(9, \"div\", 10)(10, \"div\", 11)(11, \"h5\", 12);\n    i0.ɵɵtext(12, \"\\u0628\\u064A\\u0627\\u0646\\u0627\\u062A \\u0627\\u0644\\u0634\\u062D\\u0646 \\u0648\\u0627\\u0644\\u062F\\u0641\\u0639\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(13, CheckoutComponent_div_6_div_13_Template, 2, 1, \"div\", 16);\n    i0.ɵɵelementStart(14, \"form\", 17);\n    i0.ɵɵlistener(\"ngSubmit\", function CheckoutComponent_div_6_Template_form_ngSubmit_14_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.confirmOrder());\n    });\n    i0.ɵɵelementStart(15, \"div\", 18)(16, \"label\", 19);\n    i0.ɵɵtext(17, \"\\u0627\\u0644\\u0627\\u0633\\u0645 \\u0627\\u0644\\u0643\\u0627\\u0645\\u0644\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"input\", 20);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function CheckoutComponent_div_6_Template_input_ngModelChange_18_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.fullName, $event) || (ctx_r2.fullName = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(19, \"div\", 18)(20, \"label\", 19);\n    i0.ɵɵtext(21, \"\\u0631\\u0642\\u0645 \\u0627\\u0644\\u0647\\u0627\\u062A\\u0641\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"input\", 21);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function CheckoutComponent_div_6_Template_input_ngModelChange_22_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.phone, $event) || (ctx_r2.phone = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(23, \"div\", 18)(24, \"label\", 19);\n    i0.ɵɵtext(25, \"\\u0627\\u0644\\u0645\\u062F\\u064A\\u0646\\u0629\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"input\", 22);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function CheckoutComponent_div_6_Template_input_ngModelChange_26_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.city, $event) || (ctx_r2.city = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(27, \"div\", 18)(28, \"label\", 19);\n    i0.ɵɵtext(29, \"\\u0627\\u0644\\u0634\\u0627\\u0631\\u0639\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(30, \"input\", 23);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function CheckoutComponent_div_6_Template_input_ngModelChange_30_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.street, $event) || (ctx_r2.street = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(31, \"div\", 18)(32, \"label\", 19);\n    i0.ɵɵtext(33, \"\\u0627\\u0644\\u062F\\u0648\\u0644\\u0629\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(34, \"input\", 24);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function CheckoutComponent_div_6_Template_input_ngModelChange_34_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.country, $event) || (ctx_r2.country = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(35, \"div\", 12)(36, \"label\", 19);\n    i0.ɵɵtext(37, \"\\u0637\\u0631\\u064A\\u0642\\u0629 \\u0627\\u0644\\u062F\\u0641\\u0639\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(38, \"select\", 25);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function CheckoutComponent_div_6_Template_select_ngModelChange_38_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.paymentMethod, $event) || (ctx_r2.paymentMethod = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementStart(39, \"option\", 26);\n    i0.ɵɵtext(40, \"Cash on Delivery\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(41, \"option\", 27);\n    i0.ɵɵtext(42, \"Credit Card / PayPal\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(43, \"div\", 12)(44, \"label\", 19);\n    i0.ɵɵtext(45, \"\\u0645\\u0644\\u0627\\u062D\\u0638\\u0627\\u062A \\u0625\\u0636\\u0627\\u0641\\u064A\\u0629\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(46, \"textarea\", 28);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function CheckoutComponent_div_6_Template_textarea_ngModelChange_46_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r2 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r2.notes, $event) || (ctx_r2.notes = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(47, \"button\", 29);\n    i0.ɵɵtext(48);\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.cart.items);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" Total: \", ctx_r2.cart.total, \" EGP \");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.message);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.fullName);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.phone);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.city);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.street);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.country);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.paymentMethod);\n    i0.ɵɵadvance(8);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.notes);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"disabled\", ctx_r2.submitting);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.submitting ? \"\\u062C\\u0627\\u0631\\u064A \\u0627\\u0644\\u062A\\u0623\\u0643\\u064A\\u062F...\" : \"\\u062A\\u0623\\u0643\\u064A\\u062F \\u0627\\u0644\\u0637\\u0644\\u0628\", \" \");\n  }\n}\nexport let CheckoutComponent = /*#__PURE__*/(() => {\n  class CheckoutComponent {\n    orderService;\n    router;\n    cart = null;\n    loading = true;\n    // بيانات الشحن\n    fullName = '';\n    phone = '';\n    city = '';\n    street = '';\n    country = '';\n    paymentMethod = 'cash';\n    notes = '';\n    submitting = false;\n    message = '';\n    constructor(orderService, router) {\n      this.orderService = orderService;\n      this.router = router;\n    }\n    ngOnInit() {\n      this.loadCart();\n    }\n    loadCart() {\n      this.orderService.getCurrentOrder().subscribe(res => {\n        this.cart = res;\n        this.loading = false;\n      });\n    }\n    confirmOrder() {\n      if (!this.fullName || !this.phone || !this.city || !this.street || !this.country || !this.paymentMethod) {\n        this.message = \"الرجاء ملء كل الحقول المطلوبة\";\n        return;\n      }\n      this.submitting = true;\n      this.orderService.confirmOrder(this.cart._id, {\n        fullName: this.fullName,\n        phone: this.phone,\n        city: this.city,\n        street: this.street,\n        country: this.country,\n        paymentMethod: this.paymentMethod,\n        notes: this.notes\n      }).subscribe({\n        next: res => {\n          this.message = \"تم تأكيد الطلب بنجاح!\";\n          this.submitting = false;\n          // بعد التأكيد، إعادة التوجيه لصفحة الطلبات\n          this.router.navigate(['/my-orders']);\n        },\n        error: err => {\n          this.message = err.error?.message || 'حدث خطأ';\n          this.submitting = false;\n        }\n      });\n    }\n    static ɵfac = function CheckoutComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || CheckoutComponent)(i0.ɵɵdirectiveInject(i1.OrderService), i0.ɵɵdirectiveInject(i2.Router));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: CheckoutComponent,\n      selectors: [[\"app-checkout\"]],\n      decls: 7,\n      vars: 3,\n      consts: [[1, \"baner\"], [1, \"container\", \"my-5\"], [1, \"fw-bold\", \"mb-4\"], [\"class\", \"text-center\", 4, \"ngIf\"], [\"class\", \"alert alert-info\", 4, \"ngIf\"], [\"class\", \"row\", 4, \"ngIf\"], [1, \"text-center\"], [1, \"spinner-border\"], [1, \"alert\", \"alert-info\"], [1, \"row\"], [1, \"col-lg-6\", \"mb-4\"], [1, \"card\", \"shadow-sm\", \"p-3\"], [1, \"mb-3\"], [1, \"list-group\", \"list-group-flush\"], [\"class\", \"list-group-item d-flex justify-content-between align-items-center\", 4, \"ngFor\", \"ngForOf\"], [1, \"text-end\", \"fw-bold\", \"fs-5\", \"mt-3\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [3, \"ngSubmit\"], [1, \"mb-2\"], [1, \"form-label\"], [\"type\", \"text\", \"name\", \"fullName\", \"required\", \"\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"text\", \"name\", \"phone\", \"required\", \"\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"text\", \"name\", \"city\", \"required\", \"\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"text\", \"name\", \"street\", \"required\", \"\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"text\", \"name\", \"country\", \"required\", \"\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [\"name\", \"paymentMethod\", \"required\", \"\", 1, \"form-select\", 3, \"ngModelChange\", \"ngModel\"], [\"value\", \"cash\"], [\"value\", \"card\"], [\"rows\", \"3\", \"name\", \"notes\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"submit\", 1, \"btn\", \"btn-success\", \"w-100\", 3, \"disabled\"], [1, \"list-group-item\", \"d-flex\", \"justify-content-between\", \"align-items-center\"], [1, \"d-flex\", \"align-items-center\"], [\"width\", \"50\", 1, \"me-2\", \"rounded\", 3, \"src\"], [1, \"text-muted\"], [1, \"alert\", \"alert-danger\"]],\n      template: function CheckoutComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelement(0, \"div\", 0);\n          i0.ɵɵelementStart(1, \"div\", 1)(2, \"h3\", 2);\n          i0.ɵɵtext(3, \"\\uD83D\\uDED2 Checkout\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(4, CheckoutComponent_div_4_Template, 2, 0, \"div\", 3)(5, CheckoutComponent_div_5_Template, 2, 0, \"div\", 4)(6, CheckoutComponent_div_6_Template, 49, 12, \"div\", 5);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngIf\", ctx.loading);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading && (ctx.cart == null ? null : ctx.cart.items == null ? null : ctx.cart.items.length) === 0);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading && (ctx.cart == null ? null : ctx.cart.items == null ? null : ctx.cart.items.length));\n        }\n      },\n      dependencies: [CommonModule, i3.NgForOf, i3.NgIf, FormsModule, i4.ɵNgNoValidate, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm],\n      styles: [\".baner[_ngcontent-%COMP%]{width:100%;height:200px;background-image:url(/assets/slide-01.jpg);background-size:cover;background-position:center}\"]\n    });\n  }\n  return CheckoutComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}